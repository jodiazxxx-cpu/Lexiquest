<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lexiquest - Ultimate Fixed Edition</title>
    <!-- Script agar browser mengerti React & Tailwind -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap');
        body { font-family: 'Fira Code', monospace; background-color: #02040a; color: white; overflow-x: hidden; }
        .blink { animation: blinker 1s linear infinite; }
        @keyframes blinker { 50% { opacity: 0; } }
        .timer-bar { transition: width 0.1s linear; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- SOUND ENGINE (Hacker Style) ---
        class SoundEngine {
          constructor() { this.ctx = null; }
          init() {
            if (!this.ctx) this.ctx = new (window.AudioContext || window.webkitAudioContext)();
            if (this.ctx.state === 'suspended') this.ctx.resume();
          }
          playTone(freq, type, duration, volume = 0.05) {
            this.init();
            const osc = this.ctx.createOscillator();
            const gain = this.ctx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
            gain.gain.setValueAtTime(volume, this.ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.0001, this.ctx.currentTime + duration);
            osc.connect(gain);
            gain.connect(this.ctx.destination);
            osc.start();
            osc.stop(this.ctx.currentTime + duration);
          }
          correct() { this.playTone(880, 'sine', 0.2); }
          wrong() { this.playTone(150, 'sawtooth', 0.4); }
          tick() { this.playTone(1200, 'sine', 0.02, 0.02); }
        }

        const sfx = new SoundEngine();

        const HEROES = [
          { id: 'scholar', name: 'Sang Cendekia', icon: 'üéì', skill: 'Progres x2', color: 'from-blue-600 to-indigo-700' },
          { id: 'flash', name: 'Si Kilat', icon: '‚ö°', skill: '+3dtk Waktu', color: 'from-amber-500 to-orange-600' },
          { id: 'tank', name: 'Si Kebal', icon: 'üõ°Ô∏è', skill: 'Nyawa +2', color: 'from-rose-600 to-red-700' },
        ];

        const WORDS = [
          { id: "Matahari", en: "Sun" }, { id: "Bulan", en: "Moon" }, { id: "Bintang", en: "Star" },
          { id: "Api", en: "Fire" }, { id: "Air", en: "Water" }, { id: "Bumi", en: "Earth" },
          { id: "Kucing", en: "Cat" }, { id: "Anjing", en: "Dog" }, { id: "Buku", en: "Book" },
          { id: "Mobil", en: "Car" }
        ];

        function App() {
          const [view, setView] = useState('landing');
          const [hero, setHero] = useState(null);
          const [gameState, setGameState] = useState({ lvl: 1, coins: 0, lives: 3, prog: 0, target: 5 });
          const [currentQ, setCurrentQ] = useState(null);
          const [options, setOptions] = useState([]);
          const [timer, setTimer] = useState(10);
          const timerRef = useRef(null);

          const startGame = (h) => {
            sfx.init();
            setHero(h);
            const startLives = h.id === 'tank' ? 5 : 3;
            setGameState({ lvl: 1, coins: 0, lives: startLives, prog: 0, target: 5 });
            setView('game');
            newQuestion(1, h);
          };

          const newQuestion = (lvl, curHero) => {
            const q = WORDS[Math.floor(Math.random() * WORDS.length)];
            let opts = [q.en];
            while(opts.length < 4) {
                let r = WORDS[Math.floor(Math.random() * WORDS.length)].en;
                if(!opts.includes(r)) opts.push(r);
            }
            setCurrentQ(q);
            setOptions(opts.sort(() => Math.random() - 0.5));
            const timeLimit = curHero.id === 'flash' ? 13 : 10;
            setTimer(timeLimit);
            startTimer(timeLimit);
          };

          const startTimer = (limit) => {
            if (timerRef.current) clearInterval(timerRef.current);
            let cur = limit;
            timerRef.current = setInterval(() => {
                cur -= 0.1;
                setTimer(cur);
                if (cur <= 0) {
                    clearInterval(timerRef.current);
                    handleFail();
                }
            }, 100);
          };

          const handleAnswer = (ans) => {
            clearInterval(timerRef.current);
            if (ans === currentQ.en) {
                sfx.correct();
                const progGain = hero.id === 'scholar' ? 2 : 1;
                const nextProg = gameState.prog + progGain;
                
                if (nextProg >= gameState.target) {
                    setGameState(p => ({ ...p, lvl: p.lvl + 1, prog: 0, coins: p.coins + 50, target: p.target + 2 }));
                    newQuestion(gameState.lvl + 1, hero);
                } else {
                    setGameState(p => ({ ...p, prog: nextProg, coins: p.coins + 10 }));
                    newQuestion(gameState.lvl, hero);
                }
            } else {
                handleFail();
            }
          };

          const handleFail = () => {
            sfx.wrong();
            const nextLives = gameState.lives - 1;
            if (nextLives <= 0) {
                setView('gameover');
            } else {
                setGameState(p => ({ ...p, lives: nextLives }));
                newQuestion(gameState.lvl, hero);
            }
          };

          return (
            <div className="min-h-screen flex items-center justify-center p-4 bg-slate-950">
              <div className="max-w-md w-full bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden shadow-2xl relative">
                
                {view === 'landing' && (
                  <div className="p-10 text-center space-y-8">
                    <div className="text-left text-[10px] text-blue-500/50 space-y-1">
                        <p>$ git branch -m main main_new</p>
                        <p>$ git fetch origin</p>
                    </div>
                    <h1 className="text-4xl font-black italic tracking-tighter">LEXIQUEST<span className="text-blue-500 blink">_</span></h1>
                    <button onClick={() => setView('select')} className="w-full py-4 bg-blue-600 rounded-xl font-bold shadow-lg shadow-blue-900/40">
                      JALANKAN GAME
                    </button>
                  </div>
                )}

                {view === 'select' && (
                  <div className="p-8 space-y-4">
                    <h2 className="text-center font-bold text-slate-400 uppercase tracking-widest text-xs">Pilih Akses Hero</h2>
                    {HEROES.map(h => (
                      <button key={h.id} onClick={() => startGame(h)} className={`w-full flex items-center p-4 rounded-2xl bg-gradient-to-r ${h.color} border border-white/10 active:scale-95 transition-all`}>
                        <span className="text-3xl mr-4">{h.icon}</span>
                        <div className="text-left">
                          <p className="font-bold">{h.name}</p>
                          <p className="text-[10px] uppercase opacity-70">{h.skill}</p>
                        </div>
                      </button>
                    ))}
                  </div>
                )}

                {view === 'game' && currentQ && (
                  <div className="p-8 space-y-8">
                    <div className="flex justify-between items-center text-xs font-bold text-slate-500">
                      <span>LVL {gameState.lvl}</span>
                      <div className="flex gap-1">
                        {Array.from({length: hero.id === 'tank' ? 5 : 3}).map((_, i) => (
                          <span key={i} className={i < gameState.lives ? "text-red-500" : "opacity-20"}>‚ù§Ô∏è</span>
                        ))}
                      </div>
                      <span className="text-amber-500">{gameState.coins} üí∞</span>
                    </div>

                    <div className="text-center">
                      <h3 className="text-4xl font-black mb-4">{currentQ.id}</h3>
                      <div className="w-full bg-slate-800 h-1.5 rounded-full">
                        <div 
                          className={`h-full timer-bar rounded-full ${timer < 3 ? 'bg-red-500' : 'bg-blue-500'}`} 
                          style={{ width: `${(timer / (hero.id === 'flash' ? 13 : 10)) * 100}%` }}
                        ></div>
                      </div>
                    </div>

                    <div className="grid grid-cols-2 gap-3">
                      {options.map((opt, i) => (
                        <button key={i} onClick={() => handleAnswer(opt)} className="py-4 bg-white text-black font-black rounded-xl hover:bg-blue-400 transition-colors">
                          {opt}
                        </button>
                      ))}
                    </div>
                  </div>
                )}

                {view === 'gameover' && (
                  <div className="p-10 text-center space-y-6">
                    <h2 className="text-3xl font-black text-red-500 uppercase italic">Connection Lost</h2>
                    <div className="bg-black/30 p-6 rounded-2xl border border-white/5">
                        <p className="text-xs text-slate-500 mb-2 uppercase">Final Score</p>
                        <p className="text-5xl font-black text-amber-500">{gameState.coins}</p>
                    </div>
                    <button onClick={() => setView('landing')} className="w-full py-4 bg-slate-800 rounded-xl font-bold">
                      REBOOT SYSTEM
                    </button>
                  </div>
                )}
              </div>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
